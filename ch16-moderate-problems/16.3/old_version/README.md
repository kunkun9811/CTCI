This version does not work with Vertical lines and not enough modularity
